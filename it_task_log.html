<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>MT IT Task Log</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
:root{
    --primary:#2563eb;
    --primary-dark:#1e40af;
    --card:#ffffff;
    --text:#1f2937;
    --muted:#64748b;
    --border:#e5e7eb;
    --danger:#dc2626;
}

*{ box-sizing:border-box; }

body{
    font-family:"Inter","Segoe UI",sans-serif;
    background:linear-gradient(135deg,#e0e7ff,#f8fafc);
    margin:0;
    padding:24px;
    color:var(--text);
}

h1{
    text-align:center;
    margin-bottom:24px;
    color:var(--primary-dark);
}

.container{
    max-width:1300px;
    margin:auto;
    background:var(--card);
    padding:28px;
    border-radius:16px;
    box-shadow:0 20px 40px rgba(0,0,0,.08);
}

/* FORM */
form{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(240px,1fr));
    gap:18px 22px;
    margin-bottom:32px;
}

form div{
    display:flex;
    flex-direction:column;
}

label{
    font-size:13px;
    font-weight:600;
    margin-bottom:6px;
    color:var(--muted);
}

input,select,textarea{
    padding:11px 12px;
    border-radius:10px;
    border:1px solid var(--border);
    font-size:14px;
}

input:focus,select:focus,textarea:focus{
    border-color:var(--primary);
    outline:none;
    box-shadow:0 0 0 3px rgba(37,99,235,.15);
}

textarea{ min-height:80px; resize:vertical; }

button{
    grid-column:span 3;
    padding:14px;
    border:none;
    border-radius:12px;
    background:linear-gradient(135deg,var(--primary),var(--primary-dark));
    color:white;
    font-size:15px;
    font-weight:700;
    cursor:pointer;
}

button:hover{
    box-shadow:0 10px 20px rgba(37,99,235,.35);
}
    
<button id="exportExcel" style="
    margin-bottom:16px;
    background:#16a34a;
    color:white;
    border:none;
    padding:12px 16px;
    border-radius:10px;
    font-weight:700;
    cursor:pointer;
">
ðŸ“Š Export to Excel
</button>

/* TABLE */
.table-wrapper{ overflow-x:auto; }

table{
    width:100%;
    border-collapse:separate;
    border-spacing:0;
    font-size:14px;
}

thead th{
    background:var(--primary);
    color:white;
    padding:12px;
    position:sticky;
    top:0;
}

tbody td{
    padding:10px 12px;
    border-bottom:1px solid var(--border);
}

tbody tr:hover{ background:#f8fafc; }

/* BADGES */
.badge{
    padding:4px 10px;
    border-radius:999px;
    font-size:12px;
    font-weight:600;
}

.priority-Low{background:#e0f2fe;color:#0369a1;}
.priority-Medium{background:#fef3c7;color:#92400e;}
.priority-High{background:#fee2e2;color:#991b1b;}
.priority-Critical{background:#dc2626;color:white;}

.status-Pending{background:#fde68a;color:#92400e;}
.status-Monitoring{background:#bae6fd;color:#075985;}
.status-Completed{background:#bbf7d0;color:#166534;}

.btn-view{
    background:var(--primary);
    color:white;
    border:none;
    border-radius:8px;
    padding:6px 10px;
    cursor:pointer;
}

.delete-btn{
    color:var(--danger);
    cursor:pointer;
    font-weight:700;
    margin-left:8px;
}

.edit-btn{
    color:#2563eb;
    cursor:pointer;
    font-weight:700;
}

</style>
</head>

<body>

<h1>Mountain Torq â€“ IT Task Log</h1>

<div class="container">

<form id="taskForm">
    <div>
        <label>Task Date</label>
        <input type="date" id="taskDate" required>
    </div>

    <div>
        <label>Task Title</label>
        <input type="text" id="taskTitle" required>
    </div>

    <div>
        <label>Assign To</label>
        <select id="assignTo" required>
            <option value="">Select</option>
            <option>Adly</option>
            <option>Eizzat</option>
        </select>
    </div>

    <div>
        <label>Due Date</label>
        <input type="date" id="dueDate" required>
    </div>

    <div>
        <label>Priority</label>
        <select id="priority" required>
            <option>Low</option>
            <option>Medium</option>
            <option>High</option>
            <option>Critical</option>
        </select>
    </div>

    <div>
        <label>Status</label>
        <select id="status" required>
            <option>Pending</option>
            <option>Monitoring</option>
            <option>Completed</option>
        </select>
    </div>

    <div style="grid-column:span 3;">
        <label>Description</label>
        <textarea id="description" required></textarea>
    </div>

    <div style="grid-column:span 3;">
        <label>Report URL</label>
        <input type="url" id="reportUrl">
    </div>

    <button type="submit">âž• Add Task</button>
</form>

<div class="table-wrapper">
<table>
<thead>
<tr>
    <th>ID</th>
    <th>Date</th>
    <th>Title</th>
    <th>Description</th>
    <th>Assign</th>
    <th>Due</th>
    <th>Priority</th>
    <th>Status</th>
    <th>Report</th>
    <th>Updated</th>
    <th>Action</th>
</tr>
</thead>
<tbody id="taskTable"></tbody>
</table>
</div>

</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>

<script>
firebase.initializeApp({
  apiKey: "AIzaSyA5d1rWrn9C9x5slkvkLQXW29JiMXoMSeg",
  authDomain: "tasktracker-e2329.firebaseapp.com",
  databaseURL: "https://tasktracker-e2329-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "tasktracker-e2329"
});

const db = firebase.database();
const tasksRef = db.ref("tasks");

let editingKey = null;
const submitBtn = document.querySelector("#taskForm button");

function generateTaskID(count){
    const year = new Date().getFullYear().toString().slice(-2);
    return `MT${year}${String(count+1).padStart(3,"0")}`;
}

function renderTasks(data){
    const table = document.getElementById("taskTable");
    table.innerHTML = "";
    Object.keys(data).forEach(key=>{
        const t = data[key];
        table.innerHTML += `
        <tr>
            <td>${t.id}</td>
            <td>${t.date}</td>
            <td>${t.title}</td>
            <td>${t.description}</td>
            <td>${t.assignTo}</td>
            <td>${t.dueDate}</td>
            <td><span class="badge priority-${t.priority}">${t.priority}</span></td>
            <td><span class="badge status-${t.status}">${t.status}</span></td>
            <td>${t.reportUrl ? `<button class="btn-view" onclick="window.open('${t.reportUrl}','_blank')">View</button>` : "-"}</td>
            <td>${t.updated}</td>
            <td>
            <span class="edit-btn" data-key="${key}">Edit</span>
            <span class="delete-btn" data-key="${key}">Delete</span>
            </td>
        </tr>`;
    });
}

    document.getElementById("taskTable").addEventListener("click", e => {
    const key = e.target.dataset.key;
    if (!key) return;

    if (e.target.classList.contains("edit-btn")) {
        editTask(key);
    }

    if (e.target.classList.contains("delete-btn")) {
        deleteTask(key);
    }
});
    
function editTask(key){
    tasksRef.child(key).once("value").then(snap=>{
        const t = snap.val();
        if(!t) return;

        document.getElementById("taskDate").value = t.date;
        document.getElementById("taskTitle").value = t.title;
        document.getElementById("description").value = t.description;
        document.getElementById("assignTo").value = t.assignTo;
        document.getElementById("dueDate").value = t.dueDate;
        document.getElementById("priority").value = t.priority;
        document.getElementById("status").value = t.status;
        document.getElementById("reportUrl").value = t.reportUrl || "";

        editingKey = key;
        submitBtn.textContent = "âœï¸ Update Task";
    });
}

function deleteTask(key){
    if(confirm("Delete this task?")){
        tasksRef.child(key).remove();
    }
}

document.getElementById("taskForm").addEventListener("submit", e=>{
    e.preventDefault();

    const task = {
        date: document.getElementById("taskDate").value,
        title: document.getElementById("taskTitle").value,
        description: document.getElementById("description").value,
        assignTo: document.getElementById("assignTo").value,
        dueDate: document.getElementById("dueDate").value,
        priority: document.getElementById("priority").value,
        status: document.getElementById("status").value,
        reportUrl: document.getElementById("reportUrl").value,
        updated: new Date().toLocaleString()
    };

    if(editingKey){
    task.updated = new Date().toLocaleString();
    tasksRef.child(editingKey).update(task);
    editingKey = null;
    submitBtn.textContent = "âž• Add Task";
    e.target.reset();
}else{
    tasksRef.once("value").then(snap=>{
        task.id = generateTaskID(snap.numChildren());
        tasksRef.push(task);
        e.target.reset();
    });
}
});

tasksRef.on("value", snap=>{
    renderTasks(snap.val() || {});
});
    
document.getElementById("exportExcel").addEventListener("click", () => {
    tasksRef.once("value").then(snap => {
        const data = snap.val();
        if (!data) {
            alert("No data to export");
            return;
        }

        const rows = [];

        Object.values(data).forEach(t => {
            rows.push({
                ID: t.id,
                Date: t.date,
                Title: t.title,
                Description: t.description,
                Assign_To: t.assignTo,
                Due_Date: t.dueDate,
                Priority: t.priority,
                Status: t.status,
                Report_URL: t.reportUrl || "",
                Last_Updated: t.updated
            });
        });

        const worksheet = XLSX.utils.json_to_sheet(rows);
        const workbook = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(workbook, worksheet, "IT Tasks");

        const fileName = `MT_IT_Task_Log_${new Date().toISOString().slice(0,10)}.xlsx`;
        XLSX.writeFile(workbook, fileName);
    });
});

</script>
<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>

</body>
</html>




